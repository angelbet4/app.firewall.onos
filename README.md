# app.firewall.onos
# Firewall application for ONOS controller

The idea of the application is to acquire a user request by setting three constant static integer variables in the Java source MonitorHandler.java. These constants indicate the non-surpassable traffic bandwidth, consecutive cycles of non-compliance with this limit, and the time for which the ban should remain active. The application will obtain the network topology each time, with ONOS including the host in the overall topology upon receiving the first ping. This ensures that the application always has an updated situation. The application will then construct rules for routing all packets in the network and enter an infinite loop, continuously monitoring the traffic generated by hosts and blocking them if they do not comply with the imposed rules. The block will be removed after BAN_TIME seconds. During this interval, the application continues monitoring for other hosts. The application can be terminated via the ONOS CLI.

Here is an explanation of each source file:

# Firewall.java
Defines the application's skeleton, acquiring all necessary services from ONOS for proper operation and implementing two types of Runnable on which the application is based:

# MonitorRunnable 
Responsible for monitoring through an object of type MonitorHandler. This instance will be terminated when the operation is closed.
FirewallRunnable: There will be as many instances of this class as there are temporary blocks. Each of these will be terminated after 15 seconds. This class, which is never instantiated, also defines the communication mechanism with ONOS services for proper packet routing and blocking of hosts generating DoS attacks.
The concrete class implementing the PacketProcessor class is named CustomPacketProcessor and overrides the process() method, responsible for processing each packet received by ONOS services. The class then creates rules (via intents) if they do not already exist, or simply forwards the packets.

The logic of blocking and unblocking due to the violation of Firewall limits is implemented by the drop() and undrop() methods. Two mandatory methods to implement are activate() and deactivate(), defining operations to be performed on the activation event (start the monitoring thread and listen for incoming packets) and deactivation of the application (terminate all threads and unsubscribe from ONOS services).

MonitorHandler.java: Defines the implementation of the object responsible for monitoring, whose behavior is influenced by the user's setting of constants explained in the introduction. This class, instantiated only once by the Firewall class, monitors the traffic produced by each host and sends a signal whenever a new host exceeds the limits. This leads the Firewall class to create a dedicated thread to handle this issue.

The documentation for all classes and ONOS APIs is available at http://api.onosproject.org/1.2.1/org/onosproject and related URLs.

For the firewall to function correctly, move the "telcolab-firewall" folder to the "ONOS_ROOT/apps" directory. Configure the firewall settings by modifying the static integer constants in the Java source "MonitorHandler.java," found in the directory "telcolab-firewall\telcolab-firewall\src\main\java\org\telcolab\firewall," following the instructions in the "readme.txt" file in that directory.

Compile the project using Apache Maven. Open a terminal in the project directory (ONOS_ROOT/apps/telcolab-firewall) and run the command mvn clean install, ensuring BUILD SUCCESS.

Start ONOS via Apache Karaf and install the custom application from the terminal, still in the directory mentioned above, by running the command onos-app install target/telcolab-firewall-1.0.oar.

For network simulation, use Mininet. Open a new terminal and run the command sudo mn --topo tree,2,5 --mac --switch ovsk --controller remote.

Activate the custom application by running the command app activate org.telcolab.firewall from the ONOS CLI.

Perform a pingall from the Mininet CLI in this way; ONOS will become aware of the network topology, as will the Firewall.

The Firewall is now running; by generating traffic through Mininet, you can observe its reactions.

View the application log by running the command log:tail org.telcolab.firewall from the ONOS CLI.





